<!doctype html>
<html lang="en">
  <head>
    <title>{{ [page-title] }}</title>
    <meta http-equiv="content-type" content="text/html;" charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ [include-resource "resources/main.css"] }}"/>
  </head>
  <body>
    <header>
      <nav>
        {{ [join [sort [map [navigation 0] [fn [v] [render-link v]]]] " | "] }}
      </nav>
    </header>
    <main>
      {{ content }}
      <nav class="chapter-nav">
      {{
        [when [and [not [tree/ref *page-meta* :hide-prev-next]] [or this-prev this-next]]
              [cat [fmt "<div class=\"prev-chapter\">{}</div>" [render-link this-prev]]
                   [fmt "<div class=\"next-chapter\">{}</div>" [render-link this-next]]]]
      }}
      </nav>
    </main>
    <footer>
      <div>
        by {{ [or [ref ctx :author] "Anonymous"] }}
      </div>
      <div>
        {{ [and [ref *page-meta* :date] [cat "Published " [ref *page-meta* :date]]] }}
      </div>
    </footer>
  </body>
</html>
